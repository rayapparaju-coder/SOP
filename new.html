<!DOCTYPE html>
<!-- saved from url=(0030)http://127.0.0.1:5500/new.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MASTER SOP HANDBOOK</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #4ba254 100%);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated Background Particles */
        body::before,
        body::after {
            content: '';
            position: fixed;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            animation: float 8s ease-in-out infinite;
            z-index: 0;
        }

        body::before {
            background: rgba(102, 126, 234, 0.4);
            top: -150px;
            left: -150px;
            animation-delay: 0s;
        }

        body::after {
            background: rgba(75, 162, 84, 0.4);
            bottom: -150px;
            right: -150px;
            animation-delay: 4s;
        }

        @keyframes float {

            0%,
            100% {
                transform: translate(0, 0) scale(1);
            }

            33% {
                transform: translate(100px, -100px) scale(1.1);
            }

            66% {
                transform: translate(-50px, 100px) scale(0.9);
            }
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }

        .save-download-section {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .save-btn,
        .download-btn {
            background: #4ba254;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .save-btn:hover,
        .download-btn:hover {
            background: #3d8f44;
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        .save-btn {
            background: #667eea;
        }

        .save-btn:hover {
            background: #5568d3;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #4ba254 100%);
            padding: 40px 20px;
            border-radius: 20px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin: 0 auto 30px auto;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .header-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            position: relative;
            z-index: 1;
        }

        .header-center h1 {
            color: #222;
            font-size: 3.8em;
            font-weight: 700;
            margin-bottom: 5px;
            animation: titleBounce 2s ease-in-out infinite;
        }

        @keyframes titleBounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .header-center h1::before {
            content: "üìã ";
            display: inline-block;
        }

        .header-center p {
            color: #070000;
            font-size: 30px;
            margin-top: 1;
            position: relative;
            z-index: 1;
        }

        .header-info {
            margin-top: 10px;
            border-radius: 10px;
            padding: 10px 300px;
            width: fit-content;
            display: flex;
            gap: 10px;
            justify-content: center;
            font-size: 20px;
            color: #0a0101;
            position: relative;
            z-index: 1;
        }

        .header-info span {
            border-right: 1px solid #ccc;
            padding-right: 15px;
        }

        .header-info span:last-child {
            border-right: none;
            padding-right: 0;
        }

        .main-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .main-btn {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .main-btn:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            border-color: #667eea;
        }

        .main-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #764ba2;
        }

        .main-btn h2 {
            font-size: 1.5em;
            margin-bottom: 10px;
            color: #333;
        }

        .main-btn.active h2,
        .main-btn.active p {
            color: white;
        }

        .main-btn p {
            color: #666;
            font-size: 0.9em;
        }

        .icon {
            font-size: 3em;
            margin-bottom: 20px;
            display: inline-block;
        }

        .content-area {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: none;
        }

        .content-area.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .subsection-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 30px;
            padding-bottom: 20px;
        }

        .subsection-btn {
            padding: 12px 24px;
            background: #f5f5f5;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #333;
        }

        .subsection-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .subsection-btn.active {
            background: #667eea;
            color: white;
            border-color: #764ba2;
        }

        .sop-content {
            display: none;
        }

        .sop-content.active {
            display: block;
        }

        .detail-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f0f4ff;
            border-radius: 10px;
        }

        .detail-btn {
            padding: 15px 25px;
            background: white;
            border: 2px solid #5568d3;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #5568d3;
            font-size: 15px;
        }

        .detail-btn:hover {
            background: #5568d3;
            color: white;
        }

        .detail-btn.active {
            background: #5568d3;
            color: white;
        }

        .sop-step {
            background: #f9f9f9;
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .sop-step h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .step-description {
            margin-bottom: 20px;
            color: #555;
            line-height: 1.6;
        }

        .step-image-container {
            background: linear-gradient(135deg, #e0e7ff 0%, #f0e7ff 100%);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px dashed #667eea;
            margin: 15px 0;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-image-container:hover {
            background: linear-gradient(135deg, #d0d7ff 0%, #e0d7ff 100%);
        }

        .step-image-container.has-image {
            background: white;
            border: 2px solid #e0e0e0;
            cursor: default;
            padding: 0;
        }

        .step-image-container img {
            max-width: 100%;
            width: auto;
            height: auto;
            max-height: none;
            object-fit: contain;
            border-radius: 4px;
            display: block;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }

        /* For images that need to be larger */
        .step-image-container.has-image img {
            cursor: pointer;
        }

        .route-map {
            margin-top: 30px;
            padding: 20px;
            background: #f0f4ff;
            border-radius: 8px;
        }

        .route-map h4 {
            color: #5568d3;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .route-steps {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .route-step {
            background: #5568d3;
            padding: 10px 15px;
            border-radius: 6px;
            color: white;
            font-weight: 600;
            font-size: 0.9em;
        }

        .route-arrow {
            color: #5568d3;
            font-size: 1.5em;
            font-weight: bold;
        }

        .back-btn {
            background: #f5f5f5;
            color: #333;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: #667eea;
            color: white;
        }

        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background: #4ba254;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            display: none;
        }

        .notification.show {
            display: block;
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .important-note {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff4e5;
            border-left: 5px solid #ff9900;
            border-radius: 8px;
        }

        .important-note h4 {
            margin-top: 0;
            color: #cc6600;
        }

        /* Modal Styles */
        .upload-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .upload-modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
        }

        .modal-content h3 {
            margin-top: 0;
            color: #667eea;
        }

        .modal-btn {
            width: 100%;
            padding: 15px;
            margin-bottom: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .modal-btn:hover {
            transform: translateY(-2px);
        }

        .modal-btn.primary {
            background: #667eea;
            color: white;
        }

        .modal-btn.success {
            background: #4ba254;
            color: white;
        }

        .modal-btn.secondary {
            background: #f5f5f5;
            color: #333;
        }

        #drive-link-container {
            display: none;
            margin-top: 20px;
        }

        #drive-link-container.show {
            display: block;
        }

        #drive-link-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 10px;
        }

        #url-link-container {
            display: none;
            margin-top: 20px;
        }

        #url-link-container.show {
            display: block;
        }

        #url-link-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 10px;
        }

        #url-status {
            margin-top: 10px;
            font-size: 13px;
            color: #666;
        }

        .glossary-table {
            width: 100%;
            border-collapse: collapse;
        }

        .glossary-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .glossary-table th {
            padding: 18px 15px;
            text-align: left;
            font-weight: 600;
        }

        .glossary-table td {
            padding: 18px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .glossary-table tbody tr:hover {
            background: #f0f4ff;
        }

        @media (max-width: 768px) {
            .header-center h1 {
                font-size: 1.8em;
            }

            .header-info {
                padding: 10px 20px;
                font-size: 14px;
            }

            .save-download-section {
                bottom: 10px;
                right: 10px;
            }
        }
    </style>
</head>

<body>
    <div class="save-download-section">
        <button class="save-btn" onclick="saveAllChanges()">üíæ Save All</button>
        <button class="download-btn" onclick="downloadHTML()">‚¨áÔ∏è Download</button>
    </div>

    <div class="notification" id="notification" style="background: rgb(16, 185, 129);">
                <div style="font-weight: bold; margin-bottom: 5px;">‚úÖ Images Saved!</div>
                <div style="font-size: 13px;">0 images converted, 0 already saved</div>
                <div style="font-size: 12px; margin-top: 5px;">Now press Ctrl+S to save the file permanently!</div>
            </div>

    <!-- Upload Modal -->
    <div id="uploadModal" class="upload-modal">
        <div class="modal-content">
            <h3>üì§ Upload Image</h3>
            <p style="color: #666; margin-bottom: 20px;">Choose how you want to add an image:</p>

            <button class="modal-btn primary" onclick="uploadFromDevice()">
                üíª Upload from Device
            </button>

            <button class="modal-btn success" onclick="showDriveLinkInput()">
                üîó Google Drive Link
            </button>

            <button class="modal-btn" style="background: #f59e0b; color: white;" onclick="showUrlLinkInput()">
                üåê Image URL Link
            </button>

            <button class="modal-btn secondary" onclick="closeModal()">
                ‚ùå Cancel
            </button>

            <div id="drive-link-container">
                <p style="color: #666; font-size: 14px; margin-bottom: 10px;">
                    <strong>üìù Instructions:</strong><br>
                    1. Right-click on your Google Drive file<br>
                    2. Select "Get link" ‚Üí "Anyone with the link"<br>
                    3. Copy and paste the link below
                </p>
                <input type="text" id="drive-link-input" placeholder="Paste Google Drive link here...">
                <button class="modal-btn primary" onclick="loadFromDrive()">
                    ‚úì Load Image
                </button>
                <div id="drive-status"></div>
            </div>

            <div id="url-link-container" style="display: none;">
                <p style="color: #666; font-size: 14px; margin-bottom: 10px;">
                    <strong>üìù Instructions:</strong><br>
                    1. Paste any direct image URL (from Google Sheets, Imgur, etc.)<br>
                    2. URL should end with .jpg, .png, .gif, or be a direct image link<br>
                    3. Example: https://i.imgur.com/example.png
                </p>
                <input type="text" id="url-link-input" placeholder="Paste image URL here... (e.g., https://example.com/image.png)">
                <button class="modal-btn" style="background: #f59e0b; color: white;" onclick="loadFromUrl()">
                    ‚úì Load Image
                </button>
                <div id="url-status"></div>
            </div>
        </div>
    </div>

    <div class="header">
        <div class="header-center">
            <h1>Master SOP Handbook</h1>
            <p>Standard Operating Procedures Dashboard</p>
        </div>
        <div class="header-info">
            <span>Team: L1 Connect hub support</span>
            <span>October 2025</span>
        </div>
    </div>

    <div class="container">
        <div class="main-buttons">
            <div class="main-btn active" onclick="showSection(&#39;hub-portal&#39;)">
                <div class="icon">üè¨</div>
                <h2>Hub Portal</h2>
                <p>Inbound &amp; Outbound Operations</p>
            </div>
            <div class="main-btn" onclick="showSection(&#39;rider-app&#39;)">
                <div class="icon">üõµ</div>
                <h2>Rider App</h2>
                <p>Delivery &amp; Pickup Flows</p>
            </div>
            <div class="main-btn" onclick="showSection(&#39;dashboard&#39;)">
                <div class="icon">üìä</div>
                <h2>Dashboard</h2>
                <p>Live Tracking &amp; Reports</p>
            </div>
            <div class="main-btn" onclick="showSection(&#39;exception&#39;)">
                <div class="icon">üìù</div>
                <h2>Exception Portal</h2>
                <p>Shipment Tally &amp; Exceptions</p>
            </div>
            <div class="main-btn" onclick="showSection(&#39;valinor&#39;)">
                <div class="icon">üñ•</div>
                <h2>Valinor</h2>
                <p>Login Portal</p>
            </div>
            <div class="main-btn" onclick="showSection(&#39;glossary&#39;)">
                <div class="icon">üîñ</div>
                <h2>Glossary</h2>
                <p>Terms &amp; Definitions</p>
            </div>
        </div>

        <!-- HUB PORTAL SECTION -->
        <div id="hub-portal" class="content-area active">
            <button class="back-btn" onclick="hideAllSections()">‚Üê Back to Main Menu</button>
            <h2 style="color: #667eea; margin-bottom: 20px;">üè¨ Hub Portal Activities</h2>

            <div class="subsection-nav">
                <button class="subsection-btn active" onclick="showSubsection(&#39;hub&#39;, &#39;inbound&#39;, this)">üì• Inbound
                    Process</button>
            </div>

            <div id="hub-inbound" class="sop-content active">
                <h3 style="color: #764ba2; margin-bottom: 25px;">üì• Inbound Process</h3>

                <div class="detail-nav">
                    <button class="detail-btn active" onclick="showDetail(&#39;inbound&#39;, &#39;master-manifest&#39;, this)">1Ô∏è‚É£ Master
                        Manifest Receive</button>
                </div>

                <div id="inbound-master-manifest" class="sop-detail" style="display: block;">
                    <div class="sop-step">
                        <h3><span class="step-number">1.1 </span>Receiving Manifest from Master Manifest</h3>
                        <div class="step-description">
                            <b>This process involves receiving manifests that arrive at the hub via Master Manifest
                                (MM). The Hub Incharge must verify and accept incoming shipments.</b>
                        </div>

                        <div class="step-image-container" onclick="uploadImage(this)" id="first-step-image">
                            <img src="./new_files/1.1.png" alt="MM Reaching Hub Button" onerror="this.src=&#39;https://drive.google.com/uc?export=view&amp;id=1f0harbLwM28uLgLYnWBMViGf27b33NZm&#39;; this.onerror=function(){this.style.display=&#39;none&#39;; this.parentElement.innerHTML=&#39;&lt;p style=color:#667eea;&gt;üì∏ Click here to upload image&lt;/p&gt;&#39;;};">
                        </div>
                        <p><strong>Step 1:</strong> Navigate to Hub Portal and click on "MM Reaching Hub".</p>

                        <div class="route-map">
                            <h4>üó∫Ô∏è Process Flow:</h4>
                            <div class="route-steps">
                                <div class="route-step">MM Reaching Hub</div>
                                <div class="route-arrow">‚Üí</div>
                                <div class="route-step">Receive on Trip</div>
                                <div class="route-arrow">‚Üí</div>
                                <div class="route-step">Scan Seal &amp; Manifests</div>
                                <div class="route-arrow">‚Üí</div>
                                <div class="route-step">Submit &amp; Get POD</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIDER APP SECTION -->
        <div id="rider-app" class="content-area">
            <button class="back-btn" onclick="hideAllSections()">‚Üê Back to Main Menu</button>
            <h2 style="color: #667eea; margin-bottom: 20px;">üõµ Rider App Operations</h2>

            <div class="subsection-nav">
                <button class="subsection-btn" onclick="showSubsection(&#39;rider&#39;, &#39;login&#39;, this)">üîê Login
                    Process</button>
            </div>

            <div id="rider-login" class="sop-content">
                <h3 style="color: #764ba2; margin-bottom: 25px;">üîê Rider Login Process</h3>

                <div class="sop-step">
                    <h3><span class="step-number">3.3 </span>App Login &amp; Daily Check-in</h3>
                    <div class="step-description">
                        <b>Step-by-step guide for riders to log in, verify their number, and start their daily delivery
                            operations.</b>
                    </div>

                    <div class="step-image-container" onclick="uploadImage(this)">
                        <p style="color: #667eea;">üì∏ Click here to upload image</p>
                    </div>
                    <p><strong>Step 1:</strong> Allow the app to access your <strong>Call Logs</strong> when prompted.
                    </p>

                    <div class="route-map">
                        <h4>üó∫Ô∏è Login Flow:</h4>
                        <div class="route-steps">
                            <div class="route-step">Open App &amp; Choose Language</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Allow Call Logs</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Auto Verify via Call</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Allow Notifications</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Resume Delivering</div>
                        </div>
                    </div>

                    <div class="important-note">
                        <h4>üö¥‚Äç‚ôÇÔ∏è Rider Login Process</h4>
                        <p><strong>Note:</strong> If the Rider does not receive the OTP from the <strong>Shadowfax
                                Partner</strong> platform, kindly ask the Rider to <strong>uninstall the Truecaller
                                app</strong> and <strong>unblock the spam number</strong> from the phone settings.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- DASHBOARD SECTION -->
        <div id="dashboard" class="content-area">
            <button class="back-btn" onclick="hideAllSections()">‚Üê Back to Main Menu</button>
            <h2 style="color: #667eea; margin-bottom: 20px;">üìä Dashboard &amp; Reports</h2>

            <div class="subsection-nav">
                <button class="subsection-btn" onclick="showSubsection(&#39;dash&#39;, &#39;live-tracking&#39;, this)">üî¥ Live
                    Dashboard</button>
            </div>

            <div id="dash-live-tracking" class="sop-content">
                <h3 style="color: #764ba2; margin-bottom: 25px;">üî¥ Live Dashboard</h3>

                <div class="sop-step">
                    <h3>Real-time Hub &amp; Shipment Monitoring</h3>
                    <p><strong>Live:</strong> Data is updated immediately or continuously, showing the current status.
                    </p>

                    <div class="step-image-container" onclick="uploadImage(this)" id="first-step-image">
                        <img src="./new_files/1.2.png" alt="SOP Image" onerror="this.src=&#39;https://drive.google.com/uc?export=view&amp;id=1xTsGidto9axkajUzLS-P9VmhAk02tHEV&#39;; 
                 this.onerror=function(){
                    this.style.display=&#39;none&#39;; 
                    this.parentElement.innerHTML=&#39;&lt;p style=color:#667eea;&gt;üì∏ Click here to upload image&lt;/p&gt;&#39;;
                 };">
                    </div>
                    <p><strong>Step 1:</strong> <strong>GEM ‚Äì Delivery Champion</strong><br>
                        Tracks overall hub performance, rider ranking, and delivery efficiency.</p>

                    <div class="route-map">
                        <h4>üó∫Ô∏è Process Flow:</h4>
                        <div class="route-steps">
                            <div class="route-step">Login</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Select Region/Hub</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Monitor Live Shipments</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- EXCEPTION PORTAL SECTION -->
        <div id="exception" class="content-area">
            <button class="back-btn" onclick="hideAllSections()">‚Üê Back to Main Menu</button>
            <h2 style="color: #667eea; margin-bottom: 20px;">üìù Exception Portal</h2>

            <div class="subsection-nav">
                <button class="subsection-btn" onclick="showSubsection(&#39;exc&#39;, &#39;tally&#39;, this)">üìä Shipment Tally</button>
            </div>

            <div id="exc-tally" class="sop-content">
                <h3 style="color: #764ba2; margin-bottom: 25px;">üìä Shipment Tally</h3>
                <div class="sop-step">
                    <h3>Daily Shipment Reconciliation</h3>
                    <p><strong>Shipment Tally:</strong> The process of counting and verifying incoming shipments against
                        the manifest.</p>

                    <div class="step-image-container" onclick="uploadImage(this)">
                        <p style="color: #667eea;">üì∏ Click here to upload image</p>
                    </div>
                    <p><strong>Step 1:</strong> Click on <strong>Shipment Tally</strong>.</p>

                    <div class="route-map">
                        <h4>üó∫Ô∏è Process Flow:</h4>
                        <div class="route-steps">
                            <div class="route-step">Shipments Arrive at Hub</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Check Against AWB</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Verify Accuracy &amp; Confirm</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VALINOR SECTION -->
        <div id="valinor" class="content-area">
            <button class="back-btn" onclick="hideAllSections()">‚Üê Back to Main Menu</button>
            <h2 style="color: #667eea; margin-bottom: 20px;">üñ• Valinor Login Portal</h2>

            <div class="subsection-nav">
                <button class="subsection-btn" onclick="showSubsection(&#39;val&#39;, &#39;access&#39;, this)">üîê Access &amp;
                    Login</button>
            </div>

            <div id="val-access" class="sop-content">
                <h3 style="color: #764ba2; margin-bottom: 25px;">üîê Access &amp; Login</h3>
                <div class="sop-step">
                    <h3>Valinor Portal Access</h3>
                    <p><strong>Valinor Portal:</strong> Steps to securely log in to the Valinor portal.</p>

                    <div class="step-image-container" onclick="uploadImage(this)">
                        <p style="color: #667eea;">üì∏ Click here to upload image</p>
                    </div>
                    <p><strong>Step 1:</strong> Enter your <strong>contact number</strong> and click on <strong>Send
                            OTP</strong>.</p>

                    <div class="route-map">
                        <h4>üó∫Ô∏è Process Flow:</h4>
                        <div class="route-steps">
                            <div class="route-step">Send OTP</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Enter OTP</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Submit</div>
                            <div class="route-arrow">‚Üí</div>
                            <div class="route-step">Access Portals</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GLOSSARY SECTION -->
        <div id="glossary" class="content-area">
            <button class="back-btn" onclick="hideAllSections()">‚Üê Back to Main Menu</button>
            <h2 style="color: #667eea; margin-bottom: 20px;">üîñ Glossary &amp; Definitions</h2>

            <button class="subsection-btn" style="margin-bottom: 20px; background: #667eea; color: white;">
                üìñ Key Terms
            </button>

            <div style="background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                <table class="glossary-table">
                    <thead>
                        <tr>
                            <th>Term / Acronyms</th>
                            <th>Full Form / Meaning</th>
                            <th>Description</th>
                            <th style="text-align: center;">Link to SOP</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="font-weight: 600;">AWB</td>
                            <td>Air Waybill</td>
                            <td>Unique tracking number assigned to each shipment for identification and tracking
                                purposes.</td>
                            <td style="text-align: center;">
                                <button class="detail-btn" style="padding: 8px 16px; font-size: 0.9em;" onclick="navigateToSOP(&#39;hub-portal&#39;,&#39;inbound&#39;,&#39;master-manifest&#39;)">
                                    üëâ Go to SOP
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td style="font-weight: 600;">MM</td>
                            <td>Master Manifest</td>
                            <td>A document that consolidates multiple shipments into one transport unit.</td>
                            <td style="text-align: center;">
                                <button class="detail-btn" style="padding: 8px 16px; font-size: 0.9em;" onclick="navigateToSOP(&#39;hub-portal&#39;,&#39;inbound&#39;,&#39;master-manifest&#39;)">
                                    üëâ Go to SOP
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Instructions for sharing with team -->
            <div style="margin-top: 40px; padding: 25px; background: linear-gradient(135deg, #e0f2fe 0%, #e0e7ff 100%); border-radius: 15px; border: 2px solid #667eea;">
                <h3 style="color: #667eea; margin-bottom: 15px;">üì§ How to Share This SOP with Your Team</h3>

                <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                    <h4 style="color: #4ba254; margin-bottom: 10px;">‚úÖ Step 1: Upload All Images</h4>
                    <p>Click on each image area and upload images using one of these methods:</p>
                    <ul style="margin: 10px 0 0 20px; color: #555;">
                        <li><strong>üíª Upload from Device</strong> - Best for permanent embedding</li>
                        <li><strong>üîó Google Drive Link</strong> - Quick but may have limitations</li>
                        <li><strong>üåê Image URL Link</strong> - Use Imgur or other image hosting</li>
                    </ul>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                    <h4 style="color: #4ba254; margin-bottom: 10px;">‚úÖ Step 2: Save the Document</h4>
                    <p style="margin-bottom: 10px;">After uploading all images:</p>
                    <ol style="margin: 10px 0 0 20px; color: #555;">
                        <li>Click the <strong>"üíæ Save All"</strong> button (bottom right)</li>
                        <li>Press <strong>Ctrl+S</strong> (Windows) or <strong>Cmd+S</strong> (Mac)</li>
                        <li>Save the file (e.g., "Master_SOP_Handbook.html")</li>
                    </ol>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                    <h4 style="color: #4ba254; margin-bottom: 10px;">‚úÖ Step 3: Share via Google Sheets</h4>
                    <p style="margin-bottom: 10px;">Upload the HTML file to Google Drive and create a shareable link:
                    </p>
                    <ol style="margin: 10px 0 0 20px; color: #555;">
                        <li>Upload the saved HTML file to <strong>Google Drive</strong></li>
                        <li>Right-click ‚Üí <strong>"Get link"</strong></li>
                        <li>Set to <strong>"Anyone with the link can view"</strong></li>
                        <li>Copy the link (e.g., https://drive.google.com/file/d/...)</li>
                        <li>Paste this link in your <strong>Google Sheet</strong></li>
                        <li>Team members can click the link to download and open the file</li>
                    </ol>
                </div>

                <div style="background: #fff4e5; padding: 20px; border-radius: 10px; border-left: 5px solid #f59e0b;">
                    <h4 style="color: #cc6600; margin-bottom: 10px;">üí° Pro Tips:</h4>
                    <ul style="margin: 10px 0 0 20px; color: #555;">
                        <li>All images will be embedded in the HTML file</li>
                        <li>Team members can open it in any browser without internet (after downloading)</li>
                        <li>The file is read-only, so the original won't be changed</li>
                        <li>Update the file and re-share whenever you make changes</li>
                        <li>Use the <strong>"‚¨áÔ∏è Download"</strong> button to create a clean version for sharing</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Image Storage Object - stores images as base64
        const imageStorage = {};
        let currentUploadContainer = null;

        // Check if document has been saved
        function isDocumentSaved() {
            const images = document.querySelectorAll('img');
            let allSaved = true;

            for (const img of images) {
                if (!img.src.startsWith('data:')) {
                    allSaved = false;
                    break;
                }
            }

            return allSaved;
        }

        // Disable right-click, view source, and inspect for saved documents
        function applySavedDocumentProtection() {
            document.addEventListener('contextmenu', function (e) {
                e.preventDefault();
                return false;
            });

            document.addEventListener('keydown', function (e) {
                if (e.keyCode === 123 ||
                    (e.ctrlKey && e.shiftKey && e.keyCode === 73) ||
                    (e.ctrlKey && e.shiftKey && e.keyCode === 74) ||
                    (e.ctrlKey && e.keyCode === 85) ||
                    (e.ctrlKey && e.keyCode === 83) ||
                    (e.metaKey && e.altKey && e.keyCode === 73) ||
                    (e.metaKey && e.altKey && e.keyCode === 74) ||
                    (e.metaKey && e.keyCode === 85) ||
                    (e.metaKey && e.keyCode === 83)) {
                    e.preventDefault();
                    return false;
                }
            });
        }

        // Upload Image - Show Modal
        function uploadImage(container) {
            currentUploadContainer = container;
            const modal = document.getElementById('uploadModal');
            modal.classList.add('show');

            // Reset modal state
            document.getElementById('drive-link-container').classList.remove('show');
            document.getElementById('url-link-container').classList.remove('show');
            document.getElementById('drive-link-input').value = '';
            document.getElementById('url-link-input').value = '';
            document.getElementById('drive-status').innerHTML = '';
            document.getElementById('url-status').innerHTML = '';
        }

        // Close Modal
        function closeModal() {
            const modal = document.getElementById('uploadModal');
            modal.classList.remove('show');
            currentUploadContainer = null;

            // Reset all inputs
            document.getElementById('drive-link-container').classList.remove('show');
            document.getElementById('url-link-container').classList.remove('show');
            document.getElementById('drive-link-input').value = '';
            document.getElementById('url-link-input').value = '';
            document.getElementById('drive-status').innerHTML = '';
            document.getElementById('url-status').innerHTML = '';
        }

        // Upload from Device
        function uploadFromDevice() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';

            input.onchange = function (e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (event) {
                        const imageId = 'img_' + Date.now();
                        const imageData = event.target.result;
                        imageStorage[imageId] = imageData;

                        currentUploadContainer.innerHTML = `
                            <img src="${imageData}" alt="SOP Image" data-image-id="${imageId}">
                        `;
                        currentUploadContainer.classList.add('has-image');

                        const img = currentUploadContainer.querySelector('img');
                        img.onclick = function (e) {
                            e.stopPropagation();
                            if (confirm('Do you want to replace this image?')) {
                                uploadImage(currentUploadContainer);
                            }
                        };

                        closeModal();
                        showNotification('‚úÖ Image uploaded successfully!');
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        // Show Drive Link Input
        function showDriveLinkInput() {
            document.getElementById('drive-link-container').classList.add('show');
            document.getElementById('url-link-container').classList.remove('show');
        }

        // Show URL Link Input
        function showUrlLinkInput() {
            document.getElementById('url-link-container').classList.add('show');
            document.getElementById('drive-link-container').classList.remove('show');
        }

        // Load from URL
        function loadFromUrl() {
            const input = document.getElementById('url-link-input');
            const status = document.getElementById('url-status');
            const imageUrl = input.value.trim();

            if (!imageUrl) {
                status.innerHTML = '‚ö†Ô∏è Please paste an image URL';
                status.style.color = '#f59e0b';
                return;
            }

            // Check if URL looks like an image
            const imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp', '.bmp', '.svg'];
            const hasImageExtension = imageExtensions.some(ext => imageUrl.toLowerCase().includes(ext));

            if (!hasImageExtension && !imageUrl.includes('imgur') && !imageUrl.includes('image')) {
                status.innerHTML = '‚ö†Ô∏è URL doesn\'t appear to be an image. Please check the link.';
                status.style.color = '#f59e0b';
            }

            status.innerHTML = '‚è≥ Loading image from URL...';
            status.style.color = '#667eea';

            const img = new Image();

            img.onload = function () {
                try {
                    // Try to convert to base64 for permanent embedding
                    const canvas = document.createElement('canvas');
                    canvas.width = img.naturalWidth || img.width;
                    canvas.height = img.naturalHeight || img.height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);

                    const imageData = canvas.toDataURL('image/png');
                    const imageId = 'img_' + Date.now();
                    imageStorage[imageId] = imageData;

                    currentUploadContainer.innerHTML = `
                        <img src="${imageData}" alt="SOP Image" data-image-id="${imageId}" data-original-url="${imageUrl}">
                    `;
                    currentUploadContainer.classList.add('has-image');

                    const newImg = currentUploadContainer.querySelector('img');
                    newImg.onclick = function (e) {
                        e.stopPropagation();
                        if (confirm('Do you want to replace this image?')) {
                            uploadImage(currentUploadContainer);
                        }
                    };

                    status.innerHTML = '‚úÖ Image loaded and embedded successfully!';
                    status.style.color = '#10b981';

                    setTimeout(() => {
                        closeModal();
                        showNotification('‚úÖ Image from URL loaded successfully!');
                    }, 1000);
                } catch (canvasError) {
                    // If canvas conversion fails (CORS), use direct link
                    const imageId = 'img_' + Date.now();
                    imageStorage[imageId] = imageUrl;

                    currentUploadContainer.innerHTML = `
                        <img src="${imageUrl}" alt="SOP Image" data-image-id="${imageId}" data-original-url="${imageUrl}">
                    `;
                    currentUploadContainer.classList.add('has-image');

                    const newImg = currentUploadContainer.querySelector('img');
                    newImg.onclick = function (e) {
                        e.stopPropagation();
                        if (confirm('Do you want to replace this image?')) {
                            uploadImage(currentUploadContainer);
                        }
                    };

                    status.innerHTML = '‚úÖ Image linked successfully! (Note: Image is linked, not embedded)';
                    status.style.color = '#10b981';

                    setTimeout(() => {
                        closeModal();
                        showNotification('‚úÖ Image linked successfully!');
                    }, 1500);
                }
            };

            img.onerror = function () {
                status.innerHTML = `
                    ‚ùå Could not load image from URL.<br><br>
                    <strong>Common issues:</strong><br>
                    ‚Ä¢ URL is not a direct image link<br>
                    ‚Ä¢ URL requires authentication<br>
                    ‚Ä¢ Image doesn't exist or has been removed<br>
                    ‚Ä¢ CORS restrictions prevent loading<br><br>
                    <strong>Try:</strong><br>
                    1. Upload the image to Imgur and use that link<br>
                    2. Use "Upload from Device" instead
                `;
                status.style.color = '#ef4444';
            };

            img.crossOrigin = 'anonymous';
            img.src = imageUrl;
        }

        // Load from Google Drive
        async function loadFromDrive() {
            const input = document.getElementById('drive-link-input');
            const status = document.getElementById('drive-status');
            const driveLink = input.value.trim();

            if (!driveLink) {
                status.innerHTML = '‚ö†Ô∏è Please paste a Google Drive link';
                status.style.color = '#f59e0b';
                return;
            }

            status.innerHTML = '‚è≥ Loading image from Google Drive...';
            status.style.color = '#667eea';

            try {
                // Extract file ID from various Google Drive URL formats
                let fileId = null;

                if (driveLink.includes('/file/d/')) {
                    fileId = driveLink.match(/\/file\/d\/([^\/\?]+)/)?.[1];
                } else if (driveLink.includes('id=')) {
                    fileId = driveLink.match(/id=([^&]+)/)?.[1];
                } else if (driveLink.includes('drive.google.com')) {
                    // Try to extract from any Google Drive URL
                    const matches = driveLink.match(/[-\w]{25,}/);
                    if (matches) fileId = matches[0];
                }

                if (!fileId) {
                    throw new Error('Invalid Google Drive link format. Please use a valid share link.');
                }

                // Use Google Drive thumbnail API which works better with CORS
                // sz=w2000 gives us high quality image (2000px width)
                const thumbnailUrl = `https://drive.google.com/thumbnail?id=${fileId}&sz=w2000`;

                // Also try the direct view link as fallback
                const directUrl = `https://drive.google.com/uc?export=view&id=${fileId}`;

                // Create image element to load
                const img = new Image();

                img.onload = function () {
                    // Convert to base64
                    try {
                        const canvas = document.createElement('canvas');
                        canvas.width = img.naturalWidth || img.width;
                        canvas.height = img.naturalHeight || img.height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0);

                        const imageData = canvas.toDataURL('image/png');
                        const imageId = 'img_' + Date.now();
                        imageStorage[imageId] = imageData;

                        currentUploadContainer.innerHTML = `
                            <img src="${imageData}" alt="SOP Image" data-image-id="${imageId}">
                        `;
                        currentUploadContainer.classList.add('has-image');

                        const newImg = currentUploadContainer.querySelector('img');
                        newImg.onclick = function (e) {
                            e.stopPropagation();
                            if (confirm('Do you want to replace this image?')) {
                                uploadImage(currentUploadContainer);
                            }
                        };

                        status.innerHTML = '‚úÖ Image loaded successfully!';
                        status.style.color = '#10b981';

                        setTimeout(() => {
                            closeModal();
                            showNotification('‚úÖ Image from Google Drive loaded successfully!');
                        }, 1000);
                    } catch (canvasError) {
                        // If canvas fails due to CORS, just use the image directly
                        const imageId = 'img_' + Date.now();
                        imageStorage[imageId] = img.src;

                        currentUploadContainer.innerHTML = `
                            <img src="${img.src}" alt="SOP Image" data-image-id="${imageId}">
                        `;
                        currentUploadContainer.classList.add('has-image');

                        const newImg = currentUploadContainer.querySelector('img');
                        newImg.onclick = function (e) {
                            e.stopPropagation();
                            if (confirm('Do you want to replace this image?')) {
                                uploadImage(currentUploadContainer);
                            }
                        };

                        status.innerHTML = '‚úÖ Image loaded! (Note: Image is linked, not embedded. Use "Upload from Device" for full embedding)';
                        status.style.color = '#10b981';

                        setTimeout(() => {
                            closeModal();
                            showNotification('‚úÖ Image linked successfully!');
                        }, 1500);
                    }
                };

                img.onerror = function () {
                    // Try alternative URL
                    const altImg = new Image();
                    altImg.onload = function () {
                        img.src = altImg.src;
                        img.onload();
                    };
                    altImg.onerror = function () {
                        status.innerHTML = `
                            ‚ùå Could not load image.<br><br>
                            <strong>Please ensure:</strong><br>
                            1. File sharing is set to "Anyone with the link"<br>
                            2. You copied the share link (Right-click ‚Üí Get link)<br>
                            3. The file is an image (JPG, PNG, etc.)<br><br>
                            <strong>Alternative:</strong> Download the image and use "Upload from Device" instead.
                        `;
                        status.style.color = '#ef4444';
                    };
                    altImg.src = directUrl;
                };

                // Try thumbnail first
                img.src = thumbnailUrl;

            } catch (error) {
                status.innerHTML = '‚ùå Error: ' + error.message;
                status.style.color = '#ef4444';
            }
        }

        // Show Notification
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Save All Changes
        async function saveAllChanges() {
            const notification = document.getElementById('notification');
            notification.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 5px;">üíæ Saving Images...</div>
                <div style="font-size: 13px;">Converting images to embedded format...</div>
            `;
            notification.style.background = '#3b82f6';
            notification.classList.add('show');

            await new Promise(resolve => setTimeout(resolve, 100));

            const allImages = document.querySelectorAll('img');
            let savedCount = 0;
            let alreadySavedCount = 0;

            for (const img of allImages) {
                if (img.src.startsWith('data:')) {
                    alreadySavedCount++;
                    continue;
                }

                const imageId = img.getAttribute('data-image-id');
                if (imageId && imageStorage[imageId]) {
                    img.src = imageStorage[imageId];
                    savedCount++;
                    continue;
                }

                try {
                    const response = await fetch(img.src);
                    const blob = await response.blob();

                    const base64 = await new Promise((resolve) => {
                        const reader = new FileReader();
                        reader.onloadend = () => resolve(reader.result);
                        reader.readAsDataURL(blob);
                    });

                    const newImageId = 'img_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    imageStorage[newImageId] = base64;
                    img.setAttribute('data-image-id', newImageId);
                    img.src = base64;
                    savedCount++;
                } catch (error) {
                    console.warn('Could not save image:', img.src, error);
                }
            }

            notification.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 5px;">‚úÖ Images Saved!</div>
                <div style="font-size: 13px;">${savedCount} images converted, ${alreadySavedCount} already saved</div>
                <div style="font-size: 12px; margin-top: 5px;">Now press Ctrl+S to save the file permanently!</div>
            `;
            notification.style.background = '#10b981';

            setTimeout(() => {
                alert('‚úÖ Images are now embedded!\n\nüìù IMPORTANT: Press Ctrl+S (or Cmd+S on Mac) to save this HTML file.\n\nüì§ After saving, you can share the file and all images will be included!');
            }, 500);

            setTimeout(() => {
                notification.classList.remove('show');
            }, 6000);
        }

        // Download HTML
        async function downloadHTML() {
            const notificationEl = document.getElementById('notification');
            notificationEl.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 8px; font-size: 15px;">‚ö° Preparing Download...</div>
                <div style="font-size: 13px;">Processing all sections...</div>
            `;
            notificationEl.style.background = '#8b5cf6';
            notificationEl.classList.add('show');

            await new Promise(resolve => setTimeout(resolve, 300));

            const clonedDoc = document.documentElement.cloneNode(true);

            // Process images in cloned document
            const images = document.querySelectorAll('img');
            const clonedImages = clonedDoc.querySelectorAll('img');

            for (let i = 0; i < images.length; i++) {
                const originalImg = images[i];
                const clonedImg = clonedImages[i];

                if (!clonedImg) continue;

                if (originalImg.src.startsWith('data:')) {
                    clonedImg.src = originalImg.src;
                } else if (originalImg.hasAttribute('data-image-id')) {
                    const imageId = originalImg.getAttribute('data-image-id');
                    if (imageStorage[imageId]) {
                        clonedImg.src = imageStorage[imageId];
                    }
                }
            }

            // Remove interactive elements from cloned document
            const clonedModal = clonedDoc.querySelector('#uploadModal');
            if (clonedModal) clonedModal.remove();

            const clonedSaveSection = clonedDoc.querySelector('.save-download-section');
            if (clonedSaveSection) clonedSaveSection.remove();

            const clonedNotification = clonedDoc.querySelector('.notification');
            if (clonedNotification) clonedNotification.remove();

            const clonedScripts = clonedDoc.querySelectorAll('script');
            clonedScripts.forEach(script => script.remove());

            // Make all sections visible
            const clonedSections = clonedDoc.querySelectorAll('.content-area');
            clonedSections.forEach(section => {
                section.style.display = 'block';
                section.style.marginBottom = '40px';
            });

            const clonedSubsections = clonedDoc.querySelectorAll('.sop-content');
            clonedSubsections.forEach(sub => sub.style.display = 'block');

            // Remove navigation buttons
            const clonedNavButtons = clonedDoc.querySelectorAll('.subsection-nav, .detail-nav, .back-btn, .main-buttons');
            clonedNavButtons.forEach(nav => nav.remove());

            // Add read-only banner
            const banner = clonedDoc.createElement('div');
            banner.style.cssText = `
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                text-align: center;
                font-weight: bold;
                position: sticky;
                top: 0;
                z-index: 10000;
            `;
            banner.textContent = 'üìÑ READ-ONLY VERSION - Complete SOP Handbook';
            clonedDoc.querySelector('body').insertBefore(banner, clonedDoc.querySelector('body').firstChild);

            // Create and download file
            const htmlContent = '<!DOCTYPE html>\n' + clonedDoc.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);

            const timestamp = new Date().toISOString().slice(0, 10);
            link.download = `Master_SOP_Handbook_${timestamp}.html`;
            link.click();

            notificationEl.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 8px; font-size: 16px;">‚úÖ Download Complete!</div>
                <div style="font-size: 13px;">File downloaded successfully</div>
            `;
            notificationEl.style.background = '#10b981';

            setTimeout(() => {
                notificationEl.classList.remove('show');
            }, 3000);
        }

        // Show Section
        function showSection(sectionId) {
            const allSections = document.querySelectorAll('.content-area');
            allSections.forEach(section => section.classList.remove('active'));

            const allButtons = document.querySelectorAll('.main-btn');
            allButtons.forEach(btn => btn.classList.remove('active'));

            const selectedSection = document.getElementById(sectionId);
            if (selectedSection) {
                selectedSection.classList.add('active');
            }

            event.target.closest('.main-btn').classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Hide All Sections
        function hideAllSections() {
            const allSections = document.querySelectorAll('.content-area');
            allSections.forEach(section => section.classList.remove('active'));

            const allButtons = document.querySelectorAll('.main-btn');
            allButtons.forEach(btn => btn.classList.remove('active'));

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Show Subsection
        function showSubsection(section, subsection, button) {
            const parent = button.closest('.subsection-nav');
            const allSubButtons = parent.querySelectorAll('.subsection-btn');
            allSubButtons.forEach(btn => btn.classList.remove('active'));

            button.classList.add('active');

            const allContents = button.closest('.content-area').querySelectorAll('.sop-content');
            allContents.forEach(content => content.classList.remove('active'));

            const selectedContent = document.getElementById(`${section}-${subsection}`);
            if (selectedContent) {
                selectedContent.classList.add('active');

                const allDetails = selectedContent.querySelectorAll('.sop-detail');
                allDetails.forEach(detail => detail.style.display = 'none');

                const firstDetail = selectedContent.querySelector('.sop-detail');
                if (firstDetail) {
                    firstDetail.style.display = 'block';
                }

                const detailButtons = selectedContent.querySelectorAll('.detail-btn');
                detailButtons.forEach((btn, index) => {
                    if (index === 0) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            }
        }

        // Show Detail
        function showDetail(subsection, detail, button) {
            const parent = button.closest('.detail-nav');
            const allDetailButtons = parent.querySelectorAll('.detail-btn');
            allDetailButtons.forEach(btn => btn.classList.remove('active'));

            button.classList.add('active');

            const sopContent = button.closest('.sop-content');
            const allDetails = sopContent.querySelectorAll('.sop-detail');
            allDetails.forEach(d => d.style.display = 'none');

            const selectedDetail = document.getElementById(`${subsection}-${detail}`);
            if (selectedDetail) {
                selectedDetail.style.display = 'block';
            }
        }

        // Navigate to SOP
        function navigateToSOP(section, subsection, detail) {
            hideAllSections();

            const sectionElement = document.getElementById(section);
            if (sectionElement) {
                sectionElement.classList.add('active');

                const mainBtn = document.querySelector(`[onclick="showSection('${section}')"]`);
                if (mainBtn) {
                    mainBtn.classList.add('active');
                }

                setTimeout(() => {
                    const subsectionBtn = sectionElement.querySelector(`[onclick*="'${subsection}'"]`);
                    if (subsectionBtn) {
                        subsectionBtn.click();

                        if (detail) {
                            setTimeout(() => {
                                const detailBtn = sectionElement.querySelector(`[onclick*="'${detail}'"]`);
                                if (detailBtn) {
                                    detailBtn.click();
                                    detailBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                }
                            }, 200);
                        }
                    }
                }, 300);
            }

            showNotification('Navigating to SOP... üéØ');
        }

        // Window onload
        window.onload = function () {
            if (isDocumentSaved()) {
                const saveDownloadSection = document.querySelector('.save-download-section');
                if (saveDownloadSection) {
                    saveDownloadSection.style.display = 'none';
                }
                applySavedDocumentProtection();
            }

            // Auto-load first Google Drive image
            const firstImage = document.querySelector('#first-step-image img');
            if (firstImage && firstImage.complete && !firstImage.naturalWidth) {
                firstImage.onerror();
            }
        };
    </script>
<!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>


</body></html>